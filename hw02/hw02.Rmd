---
title: "Home work 2"
author: "Ivan Zarudny"
date: "October 4, 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 1 Загрузка и очистка данных

## 1.1
>Загрузите данные в датафрейм, который назовите ``data``.

```{r}
parsed <- read.csv2("https://raw.githubusercontent.com/SergeyMirvoda/da2016/master/data/calif_penn_2011.csv", header = TRUE, sep = ",")
data <- data.frame(parsed)
```

## 1.2
>Сколько строк и столбцов в ``data``?

```{r}
nrow(data)
```

```{r}
ncol(data)
```

## 1.3
>Выполните следующую команду и объясните, что она делает. ```colSums(apply(data,c(1,2), is.na))```

```{r}
colSums(apply(data, c(1,2), is.na))
```

Функция `apply` применяет функцию к массиву (либо матрице) в определённом интервале. В данном случае передаётся таблица `table`, `c(1, 2)` обозначает, что нужно проходить по строкам и колонкам, третий аргумент `is.na` возвращает `TRUE` если все предоставленные аргументы не существуют (имеют значение `NA`).

Функция `colSums` производит суммирование по колонкам.

В итоге данная строчка кода возвращает сумму несуществующих значений по колонкам.

## 1.4
>Функция ``na.omit()`` принимает датафрейм и возвращает новый датафрейм, игнорируя строки, содержащие значение _NA_. Используйте эту функцию для удаления строк с неполными данными.

```{r}
before <- nrow(data)
data <- na.omit(data)
```

## 1.5
>Сколько строк было удалено?

```{r}
before - nrow(data)
```

## 1.6
>Соответствует ли результат выполнения, значениям из пункта 1.3?

В пункте 1.3 было указано $3070$ значений, которые имеют значение `NA`, в то время как в пункте 1.4 удаляются строки, которые ...

# 2 Новые дома

## 2.1
>Переменная(колонка) _Built_2005_or_later_ содержит данные о проценте домов, построенных с 2005 года. Постройте диаграмму рассеяния (scatterplot) медианы стоимости домов (переменная _Median_house_value_) относительно процента новых домов.

```{r}
scatter.smooth(
  data$Median_house_value,
  data$Built_2005_or_later,
  xlab = "Медиана стоимости домов",
  ylab = "")
```

## 2.2
>Постройте ещё два графика для каждого из штатов отдельно. Номер штата содержится в переменной (_STATEFP_), где Калифорния 6-й штат, а Пенсильвания 42.

```{r}
scatter.smooth(
  data$Median_house_value[data$STATEFP == 6],
  data$Built_2005_or_later[data$STATEFP == 6],
  xlab = "Медиана стоимости домов",
  ylab = "")
```

```{r}
scatter.smooth(
  data$Median_house_value[data$STATEFP == 42],
  data$Built_2005_or_later[data$STATEFP == 42],
  xlab = "Медиана стоимости домов",
  ylab = "")
```

# 3 Незанятые дома
>Уровень найма (vacancy rate) — доля домов, которые не были заняты. В данных содержатся колонки, содержащие общее количество домовладений и количество не занятых домовладений. 

## 3.1
>В датафрейм _data_ добавьте новую колонку _vacancy_rate_, которая должна содержать вышеописанный показатель.

```{r}
data$vacancy_rate <- data$Vacant_units / data$Total_units
```

## 3.2
>Найдите минимум, максимум, среднее и медиану полученных значений показателя. 

```{r}
min(data$vacancy_rate)
```

```{r}
max(data$vacancy_rate)
```

```{r}
mean(data$vacancy_rate)
```

```{r}
median(data$vacancy_rate)
```

## 3.3
>Постройте диаграмму уровня найма относительно медианы стоимости домов. Что можно заметить?

```{r}
plot(
  data$Median_house_value,
  data$vacancy_rate,
  xlab = "Средняя стоимость жилья",
  ylab = "Уровень найма"
)
```

Чем больше средняя стоимость дома, тем меньше незанятых домов.

# 4 Корреляция
>Колонка _COUNTYFP_ содержит числовой код округа внутри штата. Нас интересуют Butte County (округ 7 в Калифорнии), Santa Clara (округ 85 в Калифорнии) и York County (округ 133 в Пенсильвании).

## 4.1
>Объясните, что делает приведённый в конце задания код и как именно он это делает.

```{r}
acc <- c()
for (tract in 1:nrow(ca_pa)) {
  if (ca_pa$STATEFP[tract] == 6) {
    if (ca_pa$COUNTYFP[tract] == 1) {
      acc <- c(acc, tract)
    }
  }
}
accmv <- c()
for (tract in acc) {
  accmv <- c(accmv, ca_pa[tract,10])
}
median(accmv)
```

## 4.2
>Напишите другим способом в одну строку, то же самое, что делает нижеуказанный код. Способов получить тот же ответ множество, достаточно одного.

```{r}

```

## 4.3
>Найдите средний процент построенных домовладений в округах (Butte County, Santa Clara, York County)

```{r}

```

## 4.4
>Функция ``cor`` рассчитывает коэффициент корреляции между двумя переменными. Рассчитайте корреляцию между медианы стоимости домовладений (_Median_house_value_) и процентом построенных домов (_Built_2005_or_later_):

### 4.4.1 для всего набора данных

```{r}

```

### 4.4.2 для Калифорнии

```{r}

```

### 4.4.3 для Пенсильвании

```{r}

```

### 4.4.4 для округа Butte County

```{r}

```

### 4.4.5 для округа Santa Clara

```{r}

```

### 4.4.6 для округа York County

```{r}

```

## 4.5
>Постройте три диаграммы медианы стоимости домовладений (_Median_house_value_) относительно медианы дохода (_Median_household_income_) для трёх округов. Допустимо указать все три на одном графике.

```{r}

```

```{r}

```

```{r}

```
